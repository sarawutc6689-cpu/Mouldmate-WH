<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  margin: 15px;
}
.controls {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}
select, input, button {
  padding: 8px;
  font-size: 16px;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
th, td {
  border: 1px solid #ddd;
  padding: 8px;
}
th {
  background: #f4f4f4;
}
.highlight {
  background: yellow;
  font-weight: bold;
}
@media (max-width: 600px) {
  table, thead, tbody, th, td, tr {
    display: block;
  }
  th {
    display: none;
  }
  td {
    border: none;
    border-bottom: 1px solid #eee;
  }
  td::before {
    font-weight: bold;
    display: block;
  }
  td:nth-child(1)::before { content: "‡∏•‡∏≥‡∏î‡∏±‡∏ö"; }
  td:nth-child(2)::before { content: "‡∏£‡∏´‡∏±‡∏™ Express"; }
  td:nth-child(3)::before { content: "ITEMS"; }
  td:nth-child(4)::before { content: "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"; }
  td:nth-child(5)::before { content: "‡∏´‡∏ô‡πà‡∏ß‡∏¢"; }
}
</style>
</head>
<body>

<h2>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>

<div class="controls">
  <select id="searchType">
    <option value="items">ITEMS</option>
    <option value="detail">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</option>
    <option value="both">ITEMS + ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</option>
  </select>

  <input id="keyword" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô">
  <button onclick="search()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
</div>

<table id="table" style="display:none;">
<thead>
<tr>
<th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
<th>‡∏£‡∏´‡∏±‡∏™ Express</th>
<th>ITEMS</th>
<th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
<th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
const API = "https://script.google.com/macros/s/AKfycbwekM3dn8_8DgvP6nhZTI-MLxhvbYsMVdRym7tDuY2hUdb97Hgyg5XN-irgHaSI2EL2RA/exec";

function search() {
  const type = searchType.value;
  const q = keyword.value.trim();
  if (!q) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô");

  fetch(`${API}?type=${type}&q=${encodeURIComponent(q)}`)
    .then(r => r.json())
    .then(d => render(d, q));
}

function highlight(text, q) {
  const re = new RegExp(`(${q})`, "gi");
  return text.replace(re, `<span class="highlight">$1</span>`);
}

function render(data, q) {
  const tbody = document.querySelector("tbody");
  tbody.innerHTML = "";

  if (!data.length) {
    tbody.innerHTML = `<tr><td colspan="5">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
  }

  data.forEach(r => {
    tbody.innerHTML += `
      <tr>
        <td>${r.no}</td>
        <td>${r.express}</td>
        <td>${highlight(r.items, q)}</td>
        <td>${highlight(r.detail, q)}</td>
        <td>${r.unit}</td>
      </tr>`;
  });

  table.style.display = "table";
}
</script>

</body>
</html>
